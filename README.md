# oper

入札登録（取扱者）向けの軽量フロントエンドアプリケーションです。静的な HTML と分割された JavaScript ファイル群で構成され、CSV 貼り付けによる入札ヘッダー／品目の解析、プレビュー、Firestore への保存・状態変更（下書き・登録・入札開始/終了）などの操作を提供します。

## 主な機能

- ヘッダーCSVの貼付け・解析（入札番号、宛先、入札日、納入場所など）
- 品目CSVの貼付け・解析（品名、規格、数量、単位など）、重複チェック
- 入札データの下書き保存および登録（Firestoreを利用）
- Firebase Authentication によるログイン/ログアウト
- 取扱者向けの入札状態変更（入札開始・終了）
- クライアント側での入力検証とプレビュー表示

## ディレクトリ構成（抜粋）

- index.html — アプリ本体（UI とスクリプト読み込み順を定義）
- js/
  - 00_config.js — Firebase 設定や定数
  - 01_util.js — 汎用ユーティリティ
  - 02_auth.js — 認証ロジック
  - 03_firestore.js — Firestore 読み書きラッパー
  - 05_csv.js — CSV 解析ロジック
  - 06_validation.js — 入力検証
  - 07_state.js — クライアント状態管理
  - 08_ui_bind.js — UI とイベントのバインド
  - 09_render.js — DOM レンダリングヘルパ
  - 10_operator_a.js — 取扱者向け操作（入札状態変更など）
  - app.js — エントリポイント（初期化）

## 前提 / 動作要件

- ブラウザで動作する静的ファイル（サーバーは静的ホスティングで可）
- Firebase（Authentication と Firestore）をプロジェクトで用意すること
- 現状は Firebase の compat ビルドを CDN 経由で使用しています（将来的に ESM へ移行検討）

## セットアップ（ローカル確認）

1. このリポジトリをクローンまたはダウンロードします。
2. index.html をブラウザで開き、画面から必要な Firebase 設定（js/00_config.js 内）を反映してください。
   - Firebase コンソールでプロジェクトを作成し、Auth（メール/パスワード等）と Firestore を有効化してください。
   - Firestore のセキュリティルールは運用に合わせて適切に設定してください。
3. CSV を貼り付けて解析・プレビュー・保存を試してください。

## セキュリティ注意点

- Firebase のクライアント設定（APIキー等）は公開リポジトリに載せないでください。リポジトリに公開する場合はテスト用の限定権限プロジェクトを利用してください。
- Firestore のセキュリティルールで書き込み/読み取り権限を厳格に管理してください（認証ユーザーのみ等）。

## 改善提案 / 今後の作業候補

- README に環境変数やデプロイ手順、Firestore ルールサンプルを追記
- compat ビルドから ESM（モジュール）へ移行し、バンドラ導入（Vite 等）を検討
- CSV パーサーとバリデーションのユニットテスト追加
- UI のアクセシビリティ改善とエラーハンドリングの統一

## ライセンス

必要に応じてライセンスファイルを追加してください。
